from pwn import *

p = remote('172.17.0.2', 10007)

p.recvuntil(b'enc_flag = ')
enc_flag = int(p.recvline()[:-1].decode())

p.recvuntil(b'primes = ')
primes = p.recvline()[:-1].decode()
primes = list(map(int, primes[1:-1].split(', ')))
e = 65537 

for i in range(len(primes)):
    for j in range(i, len(primes)):
        n = primes[i] * primes[j]
        phi = (primes[i] - 1) * (primes[j] - 1)
        d = pow(e, -1, phi)
        dec_flag = pow(enc_flag, d, n)
        dec_flag = hex(dec_flag)[2:]

        if len(dec_flag) & 1:
            dec_flag = '0' + dec_flag
        dec_flag = bytes.fromhex(dec_flag)
        if dec_flag[0:6] == b'scpCTF':
            print(f'flag is : {dec_flag.decode()}')
            break


