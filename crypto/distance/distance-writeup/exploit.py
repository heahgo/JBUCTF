from gmpy2 import is_square, isqrt
from pwn import *

p = remote('172.17.0.2', 10006)

c = int(p.recvline()[2:-1].decode())
n = int(p.recvline()[2:-1].decode())
e = int(p.recvline()[2:-1].decode())

for r in range(2**15, 2**16):
    if is_square(n + r*r):
        p = isqrt(n + r*r) - r
        q = p + 2 * r
        break
        
phi = (p-1) * (q-1)
d = pow(e, -1, phi)
m = pow(c, d, n)

print(f'flag : {bytes.fromhex(hex(m)[2:]).decode()}')