from pwn import *

p = remote('172.17.0.2', 10002)

wins = 0
while True:
    count = 0
    p.recvuntil(b'Baskin Robbins ')
    value = int(p.recvuntil(b' ')[:-1])
    p.recvuntil(f'Input Numbers {count + 1} ~ '.encode())
    mod = int(p.recvuntil(b' (ex')[:-4].decode())
    p.sendline(b'1')
    p.recvline()
    i = 0
    while count != value:
        p.recvuntil(b'BOT : ')
        bot_num = p.recvline().decode()
        bot_num = list(map(int, bot_num.split(', ')))
        count = bot_num[-1]
        if count == value:
            success(f'{p.recvline()=}')
            wins += 1
            break
        if i == 0:
            r = mod - (1 + len(bot_num))
            i += 1
            if r < 0:
                exit()
        else:
            r = mod - len(bot_num)
        if r == 0:
            r = mod
            
        if value < count + r:
            send_data = [i + count + 1 for i in range(value - count - 1)]
        else:
            send_data = [i + count + 1 for i in range(r)]
        send_data = ', '.join(map(str, send_data))
        p.sendline(send_data)
        p.recvline()
    if wins == 5:
        success(p.recvline())
        exit()